<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="834.1949338373569" height="900.0103010907274"><desc>title%20Signature%20authorization%20flow%0A%0Aparticipant%20User%0A%0Aparticipant%20MPC%0Aparticipant%20Validation%20Module%0Aparticipant%20NEAR%20Blockchain%0Aparticipant%20Other%20Blockchains%0A%0A%0Aentryspacing%201.0%0AUser-%3EMPC%3A1.%20uid%2C%20msg%2C%20proof%0A%0Aactivate%20MPC%0A%0A%0AMPC-%3EValidation%20Module%3A2.%20uid%2C%20msg%2C%20proof%20%0A%0Aactivate%20Validation%20Module%0A%0A%0AValidation%20Module-%3ENEAR%20Blockchain%3A3.%20wallet_id%0Arbox%20over%20NEAR%20Blockchain%3ARegistry%20of%20wallet%5Cnauth%20methods%0AValidation%20Module%3C-NEAR%20Blockchain%3A4.%20Auth%20methods%20%5Cnfor%20wallet_id%0Aloop%205.%20Check%20each%20authorization%20method%0AValidation%20Module-%3EOther%20Blockchains%3A5.1.%20wallet_id%2C%20msg%2C%20proof%0Arbox%20over%20Other%20Blockchains%3Aauth%20contract%0AValidation%20Module%3C-Other%20Blockchains%3A5.2.%20true%2Ffalse%0Aend%0AMPC%3C-Validation%20Module%3A6.%20Validation%20result%0A%0Adeactivate%20Validation%20Module%0A%0AMPC-%3EMPC%3A7.%20Initiate%20msg%5Cnsigning%20%20for%20uid%0AUser%3C-MPC%3A8.%20Signature%0A%0Adeactivate%20MPC</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="834" height="900"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 43.35894866259375 103.10369087072726 L 43.35894866259375 900.0103010907274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 212.33027955035416 103.10369087072726 L 212.33027955035416 900.0103010907274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 396.3608863549115 103.10369087072726 L 396.3608863549115 900.0103010907274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 567.7065226327358 103.10369087072726 L 567.7065226327358 900.0103010907274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 740.8023343866342 103.10369087072726 L 740.8023343866342 900.0103010907274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878699999996 55.60594589072727 L 77.92201862518749 55.60594589072727 L 77.92201862518749 103.10369087072726 L 8.795878699999996 103.10369087072726 L 8.795878699999996 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.882935478999997" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 176.95474773473308 55.60594589072727 L 247.70581136597525 55.60594589072727 L 247.70581136597525 103.10369087072726 L 176.95474773473308 103.10369087072726 L 176.95474773473308 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="196.04180451373307" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MPC</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 319.5430022443685 55.60594589072727 L 473.1787704654545 55.60594589072727 L 473.1787704654545 103.10369087072726 L 319.5430022443685 103.10369087072726 L 319.5430022443685 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="338.6300590233685" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validation Module</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 490.7705278654545 55.60594589072727 L 644.642517400017 55.60594589072727 L 644.642517400017 103.10369087072726 L 490.7705278654545 103.10369087072726 L 490.7705278654545 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="509.8575846444545" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">NEAR Blockchain</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 662.234274800017 55.60594589072727 L 819.3703939732515 55.60594589072727 L 819.3703939732515 103.10369087072726 L 662.234274800017 103.10369087072726 L 662.234274800017 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="681.321331579017" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Other Blockchains</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 203.53440085035416 161.15649029072728 L 221.12615825035417 161.15649029072728 L 221.12615825035417 838.4391501907273 L 203.53440085035416 838.4391501907273 L 203.53440085035416 161.15649029072728" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 387.5650076549115 210.41341101072726 L 405.1567650549115 210.41341101072726 L 405.1567650549115 699.4642667307273 L 387.5650076549115 699.4642667307273 L 387.5650076549115 210.41341101072726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="285.3853073120117" y="26.547561167272725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Signature authorization flow</text></g><g><rect fill="white" stroke="none" x="64.17586158592708" y="138.28720567072727" width="118.54162634109375" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.81462519592708" y="154.1197873307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. uid, msg, proof</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 43.35894866259375 161.15649029072728 L 189.0505205910208 161.15649029072728" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(203.53440085035416,161.15649029072728) translate(-203.53440085035416,-161.15649029072728)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 188.87460301702083 153.8265913740606 L 203.53440085035416 161.15649029072728 L 188.87460301702083 168.48638920739396 Z"/></g></g><g><rect fill="white" stroke="none" x="243.0382631292539" y="187.54412639072726" width="122.61463964675781" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="245.6770267392539" y="203.37670805072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. uid, msg, proof </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 221.12615825035417 210.41341101072726 L 373.08112739557816 210.41341101072726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(387.5650076549115,210.41341101072726) translate(-387.5650076549115,-210.41341101072726)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 372.9052098215781 203.08351209406058 L 387.5650076549115 210.41341101072726 L 372.9052098215781 217.74330992739394 Z"/></g></g><g><rect fill="white" stroke="none" x="447.12145536810095" y="236.80104711072724" width="78.62037695144531" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.76021897810097" y="252.63362877072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. wallet_id</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 405.1567650549115 259.67033173072724 L 553.2226423734024 259.67033173072724" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(567.7065226327358,259.67033173072724) translate(-567.7065226327358,-259.67033173072724)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 553.0467247994025 252.34043281406056 L 567.7065226327358 259.67033173072724 L 553.0467247994025 267.0002306473939 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 487.2692091233217 301.89054949072727 L 487.2692091233217 301.89054949072727 A 15.832581659999999 15.832581659999999 0 0 1 503.1017907833217 286.05796783072725 L 632.3112544821498 286.05796783072725 L 632.3112544821498 286.05796783072725 A 15.832581659999999 15.832581659999999 0 0 1 648.1438361421498 301.89054949072727 L 648.1438361421498 328.2781855907272 L 648.1438361421498 328.2781855907272 A 15.832581659999999 15.832581659999999 0 0 1 632.3112544821498 344.11076725072724 L 503.1017907833217 344.11076725072724 L 503.1017907833217 344.11076725072724 A 15.832581659999999 15.832581659999999 0 0 1 487.2692091233217 328.2781855907272 L 487.2692091233217 301.89054949072727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="511.8976694833217" y="310.6864281907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Registry of wallet</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="511.8976694833217" y="328.2781855907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">auth methods</text></g><g><rect fill="white" stroke="none" x="428.3777191010111" y="370.49840335072724" width="116.107849485625" height="22.86928462"/><rect fill="white" stroke="none" x="428.3777191010111" y="388.09016075072725" width="83.5022586653125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.0164827110111" y="386.33098501072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Auth methods </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.0164827110111" y="403.92274241072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">for wallet_id</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 567.7065226327358 410.9594453707272 L 419.6406453142448 410.9594453707272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(405.1567650549115,410.9594453707272) translate(-405.1567650549115,-410.9594453707272)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 419.81656288824485 403.6295464540606 L 405.1567650549115 410.9594453707272 L 419.81656288824485 418.2893442873939 Z"/></g></g><g><rect fill="white" stroke="none" x="488.8554879540346" y="484.8448264507272" width="168.24812353347656" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="491.4942515640346" y="500.67740811072724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5.1. wallet_id, msg, proof</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 405.1567650549115 507.7141110707272 L 726.3184541273009 507.7141110707272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(740.8023343866342,507.7141110707272) translate(-740.8023343866342,-507.7141110707272)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 726.1425365533009 500.38421215406055 L 740.8023343866342 507.7141110707272 L 726.1425365533009 515.0440099873939 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 673.7973710359116 549.9343288307272 L 673.7973710359116 549.9343288307272 A 15.832581659999999 15.832581659999999 0 0 1 689.6299526959116 534.1017471707272 L 791.974716077357 534.1017471707272 L 791.974716077357 534.1017471707272 A 15.832581659999999 15.832581659999999 0 0 1 807.807297737357 549.9343288307272 L 807.807297737357 558.7302075307273 L 807.807297737357 558.7302075307273 A 15.832581659999999 15.832581659999999 0 0 1 791.974716077357 574.5627891907272 L 689.6299526959116 574.5627891907272 L 689.6299526959116 574.5627891907272 A 15.832581659999999 15.832581659999999 0 0 1 673.7973710359116 558.7302075307273 L 673.7973710359116 549.9343288307272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="698.4258313959116" y="558.7302075307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">auth contract</text></g><g><rect fill="white" stroke="none" x="525.9277764672182" y="600.9504252907273" width="94.10354650710937" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="528.5665400772182" y="616.7830069507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5.2. true/false</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 740.8023343866342 623.8197099107273 L 419.6406453142448 623.8197099107273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(405.1567650549115,623.8197099107273) translate(-405.1567650549115,-623.8197099107273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 419.81656288824485 616.4898109940606 L 405.1567650549115 623.8197099107273 L 419.81656288824485 631.149608827394 Z"/></g></g><g><rect fill="white" stroke="none" x="241.94307117368749" y="676.5949821107273" width="124.80502355789062" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="244.5818347836875" y="692.4275637707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Validation result</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 387.5650076549115 699.4642667307273 L 235.6100385096875 699.4642667307273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(221.12615825035417,699.4642667307273) translate(-221.12615825035417,-699.4642667307273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 235.7859560836875 692.1343678140606 L 221.12615825035417 699.4642667307273 L 235.7859560836875 706.794165647394 Z"/></g></g><g><rect fill="white" stroke="none" x="241.94307117368749" y="725.8519028307273" width="96.53733862136718" height="22.86928462"/><rect fill="white" stroke="none" x="241.94307117368749" y="743.4436602307273" width="100.62464941238281" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="244.5818347836875" y="741.6844844907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Initiate msg</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="244.5818347836875" y="759.2762418907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">signing  for uid</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 221.12615825035417 766.3129448507273 L 291.49318785035416 766.3129448507273 L 291.49318785035416 789.1822294707273 L 235.6100385096875 789.1822294707273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(221.12615825035417,789.1822294707273) translate(-221.12615825035417,-789.1822294707273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 235.7859560836875 781.8523305540606 L 221.12615825035417 789.1822294707273 L 235.7859560836875 796.512128387394 Z"/></g></g><g><rect fill="white" stroke="none" x="81.28036903221614" y="815.5698655707273" width="84.33261144851562" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="83.91913264221614" y="831.4024472307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Signature</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 203.53440085035416 838.4391501907273 L 57.84282892192708 838.4391501907273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(43.35894866259375,838.4391501907273) translate(-43.35894866259375,-838.4391501907273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.018746495927076 831.1092512740606 L 43.35894866259375 838.4391501907273 L 58.018746495927076 845.769049107394 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 325.99385675491146 437.34708147072723 L 816.6031764373569 437.34708147072723 L 816.6031764373569 650.2073460107273 L 325.99385675491146 650.2073460107273 L 325.99385675491146 437.34708147072723 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 325.99385675491146 437.34708147072723 L 325.99385675491146 458.4571903507272 L 385.9317660861615 458.4571903507272 L 396.48682052616147 447.9021359107272 L 396.48682052616147 437.34708147072723 L 325.99385675491146 437.34708147072723" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="343.58561415491147" y="451.4204873907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">loop</text><g><rect fill="white" stroke="none" x="411.43981431616146" y="438.7544220627272" width="213.8399051496875" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="414.0785779261615" y="451.4204873907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[5. Check each authorization method]</text></g></g><g/><g/><g/><g/><g/></g></svg>